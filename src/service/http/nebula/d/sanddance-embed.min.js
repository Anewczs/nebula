var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},SandDance=SandDanceExplorer.SandDance,VegaDeckGl=SandDance.VegaDeckGl,SandDanceEmbed;!function(SandDanceEmbed){function load(data,insight){return new Promise((function(resolve){var innerLoad=function(){var getPartialInsight;insight&&(getPartialInsight=function(columns){return insight}),SandDanceEmbed.sandDanceExplorer.load(data,getPartialInsight).then(resolve)},create=function(){SandDanceExplorer.use(Fabric,vega,deck,deck,luma);var explorerProps={logoClickUrl:"https://microsoft.github.io/SandDance/",mounted:function(explorer){SandDanceEmbed.sandDanceExplorer=explorer,innerLoad()}};ReactDOM.render(React.createElement(SandDanceExplorer.Explorer,explorerProps),document.getElementById("app"))};SandDanceEmbed.sandDanceExplorer?innerLoad():create()}))}function respondToRequest(requestWithSource){SandDanceEmbed.requests.push(requestWithSource);var copy=__assign({},requestWithSource);delete copy.source;var request=__assign({},copy),response;switch(request.action){case"init":response={request:request};break;case"load":var request_load=request;load(request_load.data,request_load.insight).then((function(){response={request:request},requestWithSource.source.postMessage(response,"*")})),delete request_load.data;break;case"getData":response={request:request,data:SandDanceEmbed.sandDanceExplorer.state.dataContent.data};break;case"getInsight":response={request:request,insight:SandDanceEmbed.sandDanceExplorer.viewer.getInsight()}}response&&requestWithSource.source.postMessage(response,"*")}if(SandDanceEmbed.requests=[],SandDanceEmbed.load=load,SandDanceEmbed.respondToRequest=respondToRequest,window.addEventListener("message",(function(e){var payload=e.data;if(payload){if(Array.isArray(payload)){var data,requestLoadFromArray;payload={action:"load",data:payload,insight:null}}else{var dataWithInsight=payload,requestLoadFromDataWithInsight;if(Array.isArray(dataWithInsight.data))payload=__assign({action:"load"},dataWithInsight)}var request=payload,requestWithSource;if(payload)respondToRequest(__assign({},payload,{source:e.source}))}})),window.opener){var request={action:"init",ts:new Date};respondToRequest(__assign({},request,{source:window.opener}))}}(SandDanceEmbed||(SandDanceEmbed={}));